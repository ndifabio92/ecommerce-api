<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Carrito - E-commerce</title>
    <style>
      body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto;
      padding: 20px; background-color: #f5f5f5; } .header { text-align: center;
      margin-bottom: 30px; } .cart-info { background: white; padding: 20px;
      border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px
      rgba(0,0,0,0.1); } .cart-id { font-size: 18px; font-weight: bold; color:
      #007bff; } .cart-summary { display: flex; justify-content: space-between;
      align-items: center; margin-top: 15px; padding-top: 15px; border-top: 1px
      solid #eee; } .total-items { color: #666; } .total-price { font-size:
      20px; font-weight: bold; color: #007bff; } .products-container {
      background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px
      4px rgba(0,0,0,0.1); margin-bottom: 20px; } .product-item { display: grid;
      grid-template-columns: 1fr auto auto auto auto; gap: 15px; align-items:
      center; padding: 15px; border-bottom: 1px solid #eee; }
      .product-item:last-child { border-bottom: none; } .product-info { display:
      flex; flex-direction: column; } .product-title { font-weight: bold; color:
      #333; margin-bottom: 5px; } .product-category { color: #666; font-size:
      14px; } .product-price { font-weight: bold; color: #007bff; }
      .quantity-controls { display: flex; align-items: center; gap: 10px; }
      .quantity-input { width: 60px; padding: 5px; border: 1px solid #ddd;
      border-radius: 4px; text-align: center; } .subtotal { font-weight: bold;
      color: #28a745; } .btn { padding: 8px 16px; border: none; border-radius:
      4px; cursor: pointer; text-decoration: none; display: inline-block;
      text-align: center; font-size: 14px; } .btn-primary { background-color:
      #007bff; color: white; } .btn-danger { background-color: #dc3545; color:
      white; } .btn-secondary { background-color: #6c757d; color: white; }
      .btn:hover { opacity: 0.9; } .cart-actions { display: flex; gap: 15px;
      justify-content: center; margin-top: 30px; } .empty-cart { text-align:
      center; padding: 40px; color: #666; } .empty-cart h3 { margin-bottom:
      15px; } .back-link { text-align: center; margin-top: 30px; } .back-link a
      { color: #007bff; text-decoration: none; } .back-link a:hover {
      text-decoration: underline; } .product-image { width: 60px; height: 60px;
      background: #f8f9fa; border-radius: 4px; display: flex; align-items:
      center; justify-content: center; font-size: 24px; }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>üõí Mi Carrito</h1>
    </div>

    {{#if cart}}
      <div class="cart-info">
        <div class="cart-id" data-cart-id="{{cart.id}}">Carrito ID:
          {{cart.id}}</div>
        <div class="cart-summary">
          <div class="total-items">
            {{#if cart.products.length}}
              {{cart.products.length}}
              producto{{#if (gt cart.products.length 1)}}s{{/if}}
              en el carrito
            {{else}}
              Carrito vac√≠o
            {{/if}}
          </div>
          <div class="total-price">
            Total: ${{totalPrice}}
          </div>
        </div>
      </div>

      {{#if cart.products.length}}
        <div class="products-container">
          <div
            class="product-item"
            style="font-weight: bold; border-bottom: 2px solid #007bff;"
          >
            <div>Producto</div>
            <div>Precio</div>
            <div>Cantidad</div>
            <div>Subtotal</div>
            <div>Acciones</div>
          </div>

          {{#each cart.products}}
            <div class="product-item" data-product-id="{{this.id}}">
              <div class="product-info">
                <div class="product-title">{{this.title}}</div>
                <div class="product-category">{{this.category}}</div>
              </div>
              <div class="product-price">${{this.price}}</div>
              <div class="quantity-controls">
                <input
                  type="number"
                  class="quantity-input"
                  value="{{this.quantity}}"
                  min="1"
                  max="100"
                  onchange="updateQuantity('{{this.id}}', this.value)"
                />
              </div>
              <div class="subtotal">${{multiply this.price this.quantity}}</div>
              <div>
                <button
                  class="btn btn-danger"
                  onclick="removeProduct('{{this.id}}')"
                >
                  üóëÔ∏è Eliminar
                </button>
              </div>
            </div>
          {{/each}}
        </div>

        <div class="cart-actions">
          <a href="/" class="btn btn-secondary">‚Üê Seguir Comprando</a>
          <button class="btn btn-danger" onclick="clearCart()">üóëÔ∏è Vaciar Carrito</button>
          <button class="btn btn-primary" onclick="checkout()">üí≥ Finalizar
            Compra</button>
        </div>
      {{else}}
        <div class="empty-cart">
          <h3>Tu carrito est√° vac√≠o</h3>
          <p>¬°Agrega algunos productos para comenzar a comprar!</p>
          <a href="/" class="btn btn-primary">Ver Productos</a>
        </div>
      {{/if}}
    {{else}}
      <div class="empty-cart">
        <h3>Carrito no encontrado</h3>
        <p>El carrito que buscas no existe o ha sido eliminado.</p>
        <a href="/" class="btn btn-primary">Volver a Productos</a>
      </div>
    {{/if}}

    <div class="back-link">
      <a href="/">‚Üê Volver al inicio</a>
    </div>

    <!-- Include Socket.IO client library first -->
    <script src="/socket.io/socket.io.js"></script>
    <!-- Then include our custom script -->
    <script src="/js/cart-realtime.js"></script>

  </body>
</html>